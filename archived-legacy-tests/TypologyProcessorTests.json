{
	"info": {
		"_postman_id": "71d3e4b4-79a0-488e-a05d-99e49fd4001a",
		"name": "Typology Processor",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "8089578"
	},
	"item": [
		{
			"name": "Typology Processor",
			"item": [
				{
					"name": "Test 1 Check that we received the right incoming message",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"pm.test(\"Status code is 200\", function () {\r",
									"    pm.response.to.have.status(200);\r",
									"});\r",
									"\r",
									"pm.test(\"Same transaction than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId);\r",
									"});\r",
									"\r",
									"pm.test(\"Same network map than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap._key).to.eq(\"26345403\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].id).to.eq(\"028@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].cfg).to.eq(\"1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Result only has Rule 003 result payload\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].result).to.true;\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].reason).to.eq(\"asdf\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].subRuleRef).to.eq(\"123\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11 \",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"subRuleRef\": \"123\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.0.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"028@1.0.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 2.1 Rule-003 Check that we can determine the correct beneficiary typologies",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"pm.test(\"Network sub-map processed correctly Rule-003 Typology-028\", function () {\r",
									"    pm.expect(responseJson.cadpRequests).to.length(2);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});\r",
									"pm.test(\"Network sub-map processed correctly Rule-003 Typology-029\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[1].typologyResult.id).to.eq(\"029@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.0.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                \"id\": \"029@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"005@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-005-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 2.2 Rule-004 Check that we can determine the correct beneficiary typologies",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"pm.test(\"Network sub-map processed correctly Rule-004 Typology-028\", function () {\r",
									"    pm.expect(responseJson.cadpRequests).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"004@1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.0.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                \"id\": \"029@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"005@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-005-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 2.3 Rule-005 Check that we can determine the correct beneficiary typologies",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"pm.test(\"Network sub-map processed correctly Rule-005 Typology-029\", function () {\r",
									"    pm.expect(responseJson.cadpRequests).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"029@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"005@1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.0.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            },\r\n                            {\r\n                                \"id\": \"029@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"005@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-005-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 3.1 and 4.1 Check that we can determine typology completion correctly",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(100);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"999_003@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());\r",
									"const arangourl = pm.globals.get(\"arangourl\");\r",
									"\r",
									"const TPConfig = [\r",
									"    { \r",
									"      \"id\":\"999_003@1.0.0\",\r",
									"      \"cfg\":\"1.0.0\",\r",
									"      \"rules\":[\r",
									"         {\r",
									"            \"id\":\"003@1.1.0\",\r",
									"            \"cfg\":\"1.1.0\",\r",
									"            \"ref\":\".01\",\r",
									"            \"true\":100,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"003@1.1.0\",\r",
									"            \"cfg\":\"1.1.0\",\r",
									"            \"ref\":\".02\",\r",
									"            \"true\":100,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"003@1.1.0\",\r",
									"            \"cfg\":\"1.1.0\",\r",
									"            \"ref\":\".03\",\r",
									"            \"true\":100,\r",
									"            \"false\":0\r",
									"         }\r",
									"      ],\r",
									"      \"expression\":{\r",
									"         \"operator\":\"+\",\r",
									"         \"terms\":[\r",
									"            {\r",
									"               \"id\":\"003@1.1.0\",\r",
									"               \"cfg\":\"1.1.0\"\r",
									"            }\r",
									"         ]\r",
									"      }\r",
									"   }\r",
									"]\r",
									"\r",
									"// Seed Typology config to Configuration collection\r",
									"pm.sendRequest({\r",
									"    url: `${arangourl}/_db/Configuration/_api/cursor`,\r",
									"    method: 'POST',\r",
									"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR config IN ${JSON.stringify(TPConfig)}\r",
									"                    INSERT {_key: \"999_003\", id: config.id, cfg: config.cfg, rules: config.rules, expression: config.expression  } INTO typologyExpression\r",
									"                    OPTIONS { overwrite: true }`\r",
									"        })\r",
									"    }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"c51ec534-ee48-4575-b6a9-ead2955b8069\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"2021-10-07T09:30:31.000Z\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.1.0\",\r\n        \"cfg\": \"1.1.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".01\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"003\",\r\n        \"_id\": \"networkConfiguration/003\",\r\n        \"_rev\": \"_eR3Kff2--_\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"004_003@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pacs.002.001.12\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.0.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"999_003@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.1.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-1-0\",\r\n                                        \"cfg\": \"1.1.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 3.2 and 4.2 Check that we can determine typology completion correctly",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.1.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 3.3 Check that we can determine typology completion correctly",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(150);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"999_004@1.0.1\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());\r",
									"const arangourl = pm.globals.get(\"arangourl\");\r",
									"\r",
									"const TPConfig = [\r",
									"{ \r",
									"      \"id\":\"999_004@1.0.1\",\r",
									"      \"cfg\":\"1.0.1\",\r",
									"      \"rules\":[\r",
									"         {\r",
									"            \"id\":\"004@1.1.0\",\r",
									"            \"cfg\":\"1.1.0\",\r",
									"            \"ref\":\".01\",\r",
									"            \"true\":150,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.1.0\",\r",
									"            \"cfg\":\"1.1.0\",\r",
									"            \"ref\":\".02\",\r",
									"            \"true\":150,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.1.0\",\r",
									"            \"cfg\":\"1.1.0\",\r",
									"            \"ref\":\".03\",\r",
									"            \"true\":150,\r",
									"            \"false\":0\r",
									"         }\r",
									"      ],\r",
									"      \"expression\":{\r",
									"         \"operator\":\"+\",\r",
									"         \"terms\":[\r",
									"            {\r",
									"               \"id\":\"004@1.1.0\",\r",
									"               \"cfg\":\"1.1.0\"\r",
									"            }\r",
									"         ]\r",
									"      }\r",
									"}\r",
									"]\r",
									"\r",
									"// Seed Typology config to Configuration collection\r",
									"pm.sendRequest({\r",
									"    url: `${arangourl}/_db/Configuration/_api/cursor`,\r",
									"    method: 'POST',\r",
									"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR config IN ${JSON.stringify(TPConfig)}\r",
									"                    INSERT {_key: \"999_004_2\", id: config.id, cfg: config.cfg, rules: config.rules, expression: config.expression  } INTO typologyExpression\r",
									"                    OPTIONS { overwrite: true }`\r",
									"        })\r",
									"    }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"004@1.1.0\",\r\n        \"cfg\": \"1.1.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".02\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.0.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"999_004@1.0.1\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.1\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"004@1.1.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-1-0\",\r\n                                        \"cfg\": \"1.1.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 5.1 Rule-003 Check that we can we calculate the typology score successfully",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology incomplete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 5.1 Rule-004 Check that we can we calculate the typology score successfully",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete with Score = 150\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(150);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"999_004@1.1.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());\r",
									"const arangourl = pm.globals.get(\"arangourl\");\r",
									"\r",
									"const TPConfig = [\r",
									"{ \r",
									"      \"id\":\"999_004@1.1.0\",\r",
									"      \"cfg\":\"1.1.0\",\r",
									"      \"rules\":[\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".01\",\r",
									"            \"true\":150,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".02\",\r",
									"            \"true\":150,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".03\",\r",
									"            \"true\":150,\r",
									"            \"false\":0\r",
									"         }\r",
									"      ],\r",
									"      \"expression\":{\r",
									"         \"operator\":\"+\",\r",
									"         \"terms\":[\r",
									"            {\r",
									"               \"id\":\"004@1.0.0\",\r",
									"               \"cfg\":\"1.0.0\"\r",
									"            }\r",
									"         ]\r",
									"      }\r",
									"}\r",
									"]\r",
									"\r",
									"// Seed Typology config to Configuration collection\r",
									"pm.sendRequest({\r",
									"    url: `${arangourl}/_db/Configuration/_api/cursor`,\r",
									"    method: 'POST',\r",
									"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR config IN ${JSON.stringify(TPConfig)}\r",
									"                    INSERT {_key: \"999_004_1\", id: config.id, cfg: config.cfg, rules: config.rules, expression: config.expression  } INTO typologyExpression\r",
									"                    OPTIONS { overwrite: true }`\r",
									"        })\r",
									"    }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"004@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".03\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.0.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"999_004@1.1.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 5.2 Rule-003 Check that we can we calculate the typology score successfully",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology incomplete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 5.2 Rule-004 Check that we can we calculate the typology score successfully",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete with Score = 100\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(100);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"999_004@1.1.1\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());\r",
									"const arangourl = pm.globals.get(\"arangourl\");\r",
									"\r",
									"const TPConfig = [\r",
									"{ \r",
									"      \"id\":\"999_004@1.1.1\",\r",
									"      \"cfg\":\"1.1.1\",\r",
									"      \"rules\":[\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".01\",\r",
									"            \"true\":150,\r",
									"            \"false\":100\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".02\",\r",
									"            \"true\":150,\r",
									"            \"false\":100\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".03\",\r",
									"            \"true\":150,\r",
									"            \"false\":100\r",
									"         }\r",
									"      ],\r",
									"      \"expression\":{\r",
									"         \"operator\":\"+\",\r",
									"         \"terms\":[\r",
									"            {\r",
									"               \"id\":\"004@1.0.0\",\r",
									"               \"cfg\":\"1.0.0\"\r",
									"            }\r",
									"         ]\r",
									"      }\r",
									"}\r",
									"]\r",
									"\r",
									"// Seed Typology config to Configuration collection\r",
									"pm.sendRequest({\r",
									"    url: `${arangourl}/_db/Configuration/_api/cursor`,\r",
									"    method: 'POST',\r",
									"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR config IN ${JSON.stringify(TPConfig)}\r",
									"                    INSERT {_key: \"999_004_3\", id: config.id, cfg: config.cfg, rules: config.rules, expression: config.expression  } INTO typologyExpression\r",
									"                    OPTIONS { overwrite: true }`\r",
									"        })\r",
									"    }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"004@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": false,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".01\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.0.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"999_004@1.1.1\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.1\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 5.3 Rule-003 Check that we can we calculate the typology score successfully",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology incomplete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": false,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 5.3 Rule-004 Check that we can we calculate the typology score successfully",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete with Score = 50\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(50);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"999_004@1.1.2\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());\r",
									"const arangourl = pm.globals.get(\"arangourl\");\r",
									"\r",
									"const TPConfig = [\r",
									"{ \r",
									"      \"id\":\"999_004@1.1.2\",\r",
									"      \"cfg\":\"1.1.2\",\r",
									"      \"rules\":[\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".01\",\r",
									"            \"true\":50,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".02\",\r",
									"            \"true\":50,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".03\",\r",
									"            \"true\":50,\r",
									"            \"false\":0\r",
									"         }\r",
									"      ],\r",
									"      \"expression\":{\r",
									"         \"operator\":\"+\",\r",
									"         \"terms\":[\r",
									"            {\r",
									"               \"id\":\"004@1.0.0\",\r",
									"               \"cfg\":\"1.0.0\"\r",
									"            }\r",
									"         ]\r",
									"      }\r",
									"}\r",
									"]\r",
									"\r",
									"// Seed Typology config to Configuration collection\r",
									"pm.sendRequest({\r",
									"    url: `${arangourl}/_db/Configuration/_api/cursor`,\r",
									"    method: 'POST',\r",
									"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR config IN ${JSON.stringify(TPConfig)}\r",
									"                    INSERT {_key: \"999_004_4\", id: config.id, cfg: config.cfg, rules: config.rules, expression: config.expression  } INTO typologyExpression\r",
									"                    OPTIONS { overwrite: true }`\r",
									"        })\r",
									"    }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"004@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".01\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.0.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"999_004@1.1.2\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.2\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 5.4 Rule-003 Check that we can we calculate the typology score successfully",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology incomplete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": false,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".02\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 5.4 Rule-003 Check that we can we calculate the typology score successfully Copy",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete with Score = 0\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": false,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".02\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 6.1 Rule-003 Check that we are we sending the right outgoing message to the CADProc",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology incomplete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Same transaction than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId);\r",
									"});\r",
									"\r",
									"pm.test(\"Same network map than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap._key).to.eq(\"26345403\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].id).to.eq(\"028@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].cfg).to.eq(\"1.1.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules).to.length(2);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].cfg).to.eq(\"1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Result only has Rule 003 result payload\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].result).to.true;\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].reason).to.eq(\"asdf\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].subRuleRef).to.eq(\".02\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".02\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 6.1 Rule-004 Check that we are we sending the right outgoing message to the CADProc Copy 2",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete with Score = 150\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(150);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"999_004@1.1.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Same transaction than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId);\r",
									"});\r",
									"\r",
									"pm.test(\"Same network map than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap._key).to.eq(\"26345403\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].id).to.eq(\"999_004@1.1.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].cfg).to.eq(\"1.1.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].id).to.eq(\"004@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].cfg).to.eq(\"1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Result has Rule 004 result payload\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].id).to.eq(\"004@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].result).to.true;\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].reason).to.eq(\"asdf\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].subRuleRef).to.eq(\".01\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());\r",
									"const arangourl = pm.globals.get(\"arangourl\");\r",
									"\r",
									"const TPConfig = [\r",
									"{ \r",
									"      \"id\":\"999_004@1.1.0\",\r",
									"      \"cfg\":\"1.1.0\",\r",
									"      \"rules\":[\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".01\",\r",
									"            \"true\":150,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".02\",\r",
									"            \"true\":150,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".03\",\r",
									"            \"true\":150,\r",
									"            \"false\":0\r",
									"         }\r",
									"      ],\r",
									"      \"expression\":{\r",
									"         \"operator\":\"+\",\r",
									"         \"terms\":[\r",
									"            {\r",
									"               \"id\":\"004@1.0.0\",\r",
									"               \"cfg\":\"1.0.0\"\r",
									"            }\r",
									"         ]\r",
									"      }\r",
									"}\r",
									"]\r",
									"\r",
									"// Seed Typology config to Configuration collection\r",
									"pm.sendRequest({\r",
									"    url: `${arangourl}/_db/Configuration/_api/cursor`,\r",
									"    method: 'POST',\r",
									"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR config IN ${JSON.stringify(TPConfig)}\r",
									"                    INSERT {_key: \"999_004_1\", id: config.id, cfg: config.cfg, rules: config.rules, expression: config.expression  } INTO typologyExpression\r",
									"                    OPTIONS { overwrite: true }`\r",
									"        })\r",
									"    }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"004@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".01\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"999_004@1.1.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 6.2 Rule-003 Check that we are we sending the right outgoing message to the CADProc",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology incomplete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Same transaction than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId);\r",
									"});\r",
									"\r",
									"pm.test(\"Same network map than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap._key).to.eq(\"26345403\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].id).to.eq(\"028@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].cfg).to.eq(\"1.1.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules).to.length(2);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].cfg).to.eq(\"1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Result only has Rule 003 result payload\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].result).to.true;\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].reason).to.eq(\"asdf\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].subRuleRef).to.eq(\"123\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 6.2 Rule-004 Check that we are we sending the right outgoing message to the CADProc",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete with Score = 100\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(100);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"999_004@1.0.2\");\r",
									"});\r",
									"\r",
									"pm.test(\"Same transaction than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId);\r",
									"});\r",
									"\r",
									"pm.test(\"Same network map than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap._key).to.eq(\"26345403\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].id).to.eq(\"999_004@1.0.2\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].cfg).to.eq(\"1.0.2\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].id).to.eq(\"004@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].cfg).to.eq(\"1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Result has Rule 003 and Rule 004 result payload\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].id).to.eq(\"004@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].result).to.false;\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].reason).to.eq(\"asdf\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].subRuleRef).to.eq(\".02\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());\r",
									"const arangourl = pm.globals.get(\"arangourl\");\r",
									"\r",
									"const TPConfig = [\r",
									"{ \r",
									"      \"id\":\"999_004@1.0.2\",\r",
									"      \"cfg\":\"1.0.2\",\r",
									"      \"rules\":[\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".01\",\r",
									"            \"true\":150,\r",
									"            \"false\":100\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".02\",\r",
									"            \"true\":150,\r",
									"            \"false\":100\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".03\",\r",
									"            \"true\":150,\r",
									"            \"false\":100\r",
									"         }\r",
									"      ],\r",
									"      \"expression\":{\r",
									"         \"operator\":\"+\",\r",
									"         \"terms\":[\r",
									"            {\r",
									"               \"id\":\"004@1.0.0\",\r",
									"               \"cfg\":\"1.0.0\"\r",
									"            }\r",
									"         ]\r",
									"      }\r",
									"}\r",
									"]\r",
									"\r",
									"// Seed Typology config to Configuration collection\r",
									"pm.sendRequest({\r",
									"    url: `${arangourl}/_db/Configuration/_api/cursor`,\r",
									"    method: 'POST',\r",
									"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR config IN ${JSON.stringify(TPConfig)}\r",
									"                    INSERT {_key: \"999_004_5\", id: config.id, cfg: config.cfg, rules: config.rules, expression: config.expression  } INTO typologyExpression\r",
									"                    OPTIONS { overwrite: true }`\r",
									"        })\r",
									"    }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"004@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": false,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".02\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"999_004@1.0.2\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.2\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 6.3 Rule-003 Check that we are we sending the right outgoing message to the CADProc",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology incomplete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Same transaction than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId);\r",
									"});\r",
									"\r",
									"pm.test(\"Same network map than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap._key).to.eq(\"26345403\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].id).to.eq(\"028@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].cfg).to.eq(\"1.1.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules).to.length(2);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].cfg).to.eq(\"1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Result only has Rule 003 result payload\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].result).to.false;\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].reason).to.eq(\"asdf\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].subRuleRef).to.eq(\"123\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": false,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 6.3 Rule-004 Check that we are we sending the right outgoing message to the CADProc",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete with Score = 50\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(50);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"999_004@1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Same transaction than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId);\r",
									"});\r",
									"\r",
									"pm.test(\"Same network map than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap._key).to.eq(\"26345403\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].id).to.eq(\"999_004@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].cfg).to.eq(\"1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].id).to.eq(\"004@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].cfg).to.eq(\"1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Result has Rule 003 and Rule 004 result payload\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].id).to.eq(\"004@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].result).to.true;\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].reason).to.eq(\"asdf\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].subRuleRef).to.eq(\".01\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());\r",
									"const arangourl = pm.globals.get(\"arangourl\");\r",
									"\r",
									"const TPConfig = [\r",
									"{ \r",
									"      \"id\":\"999_004@1.0.0\",\r",
									"      \"cfg\":\"1.0.0\",\r",
									"      \"rules\":[\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".01\",\r",
									"            \"true\":50,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".02\",\r",
									"            \"true\":50,\r",
									"            \"false\":0\r",
									"         },\r",
									"         {\r",
									"            \"id\":\"004@1.0.0\",\r",
									"            \"cfg\":\"1.0.0\",\r",
									"            \"ref\":\".03\",\r",
									"            \"true\":50,\r",
									"            \"false\":0\r",
									"         }\r",
									"      ],\r",
									"      \"expression\":{\r",
									"         \"operator\":\"+\",\r",
									"         \"terms\":[\r",
									"            {\r",
									"               \"id\":\"004@1.0.0\",\r",
									"               \"cfg\":\"1.0.0\"\r",
									"            }\r",
									"         ]\r",
									"      }\r",
									"}\r",
									"]\r",
									"\r",
									"// Seed Typology config to Configuration collection\r",
									"pm.sendRequest({\r",
									"    url: `${arangourl}/_db/Configuration/_api/cursor`,\r",
									"    method: 'POST',\r",
									"    header: { 'Authorization': `Bearer ${pm.globals.get(\"arangoToken\")}` },\r",
									"    body: {\r",
									"        mode: 'raw',\r",
									"        raw: JSON.stringify({\r",
									"            query: `FOR config IN ${JSON.stringify(TPConfig)}\r",
									"                    INSERT {_key: \"999_004\", id: config.id, cfg: config.cfg, rules: config.rules, expression: config.expression  } INTO typologyExpression\r",
									"                    OPTIONS { overwrite: true }`\r",
									"        })\r",
									"    }\r",
									"});"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"004@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": true,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \".01\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1.0\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"999_004@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.0.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 6.4 Rule-003 Check that we are we sending the right outgoing message to the CADProc",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology incomplete\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Same transaction than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId);\r",
									"});\r",
									"\r",
									"pm.test(\"Same network map than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap._key).to.eq(\"26345403\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].id).to.eq(\"028@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].cfg).to.eq(\"1.1.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules).to.length(2);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].cfg).to.eq(\"1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Result only has Rule 003 result payload\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].id).to.eq(\"003@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].result).to.false;\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].reason).to.eq(\"asdf\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].subRuleRef).to.eq(\"123\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"003@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": false,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"003@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-003-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    },\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				},
				{
					"name": "Test 6.4 Rule-004 Check that we are we sending the right outgoing message to the CADProc",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const responseJson = pm.response.json();\r",
									"\r",
									"pm.test(\"Typology complete with Score = 0\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.result).to.eq(0);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.id).to.eq(\"028@1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Same transaction than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId).to.eq(responseJson.cadpRequests[0].transaction.CstmrCdtTrfInitn.PmtInf.CdtTrfTxInf.PmtId.EndToEndId);\r",
									"});\r",
									"\r",
									"pm.test(\"Same network map than sent\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap._key).to.eq(\"26345403\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].id).to.eq(\"028@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].cfg).to.eq(\"1.1.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].id).to.eq(\"004@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].networkMap.messages[0].channels[0].typologies[0].rules[0].cfg).to.eq(\"1.0.0\");\r",
									"});\r",
									"\r",
									"pm.test(\"Result has Rule 003 and Rule 004 result payload\", function () {\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults).to.length(1);\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].id).to.eq(\"004@1.0.0\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].result).to.false;\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].reason).to.eq(\"asdf\");\r",
									"    pm.expect(responseJson.cadpRequests[0].typologyResult.ruleResults[0].subRuleRef).to.eq(\"123\");\r",
									"});"
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									"const now = new Date().getTime();\r",
									"pm.globals.set(\"now\", new Date().toISOString());"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\r\n    \"transaction\": {\r\n        \"TxTp\": \"pain.001.001.11\",\r\n        \"CstmrCdtTrfInitn\": {\r\n            \"GrpHdr\": {\r\n                \"MsgId\": \"{{$guid}}\",\r\n                \"CreDtTm\": \"{{now}}\",\r\n                \"NbOfTxs\": 1,\r\n                \"InitgPty\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                }\r\n            },\r\n            \"PmtInf\": {\r\n                \"PmtInfId\": \"{{$guid}}\",\r\n                \"PmtMtd\": \"TRA\",\r\n                \"ReqdAdvcTp\": {\r\n                    \"DbtAdvc\": {\r\n                        \"Cd\": \"ADWD\",\r\n                        \"Prtry\": \"Advice with transaction details\"\r\n                    }\r\n                },\r\n                \"ReqdExctnDt\": {\r\n                    \"Dt\": \"2021-10-07\",\r\n                    \"DtTm\": \"{{now}}\"\r\n                },\r\n                \"Dbtr\": {\r\n                    \"Nm\": \"Ivan Reese Russel-Klein\",\r\n                    \"Id\": {\r\n                        \"PrvtId\": {\r\n                            \"DtAndPlcOfBirth\": {\r\n                                \"BirthDt\": \"1967-11-23\",\r\n                                \"CityOfBirth\": \"Unknown\",\r\n                                \"CtryOfBirth\": \"ZZ\"\r\n                            },\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        }\r\n                    },\r\n                    \"CtctDtls\": {\r\n                        \"MobNb\": \"+27-783078685\"\r\n                    }\r\n                },\r\n                \"DbtrAcct\": {\r\n                    \"Id\": {\r\n                        \"Othr\": {\r\n                            \"Id\": \"+27783078685\",\r\n                            \"SchmeNm\": {\r\n                                \"Prtry\": \"PASSPORT\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Nm\": \"Ivan Russel-Klein\"\r\n                },\r\n                \"DbtrAgt\": {\r\n                    \"FinInstnId\": {\r\n                        \"ClrSysMmbId\": {\r\n                            \"MmbId\": \"dfsp001\"\r\n                        }\r\n                    }\r\n                },\r\n                \"CdtTrfTxInf\": {\r\n                    \"PmtId\": {\r\n                        \"EndToEndId\": \"{{$guid}}\"\r\n                    },\r\n                    \"PmtTpInf\": {\r\n                        \"CtgyPurp\": {\r\n                            \"Prtry\": \"TRANSFER\"\r\n                        }\r\n                    },\r\n                    \"Amt\": {\r\n                        \"InstdAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            }\r\n                        },\r\n                        \"EqvtAmt\": {\r\n                            \"Amt\": {\r\n                                \"Amt\": \"50431891779910900\",\r\n                                \"Ccy\": \"USD\"\r\n                            },\r\n                            \"CcyOfTrf\": \"USD\"\r\n                        }\r\n                    },\r\n                    \"ChrgBr\": \"DEBT\",\r\n                    \"CdtrAgt\": {\r\n                        \"FinInstnId\": {\r\n                            \"ClrSysMmbId\": {\r\n                                \"MmbId\": \"dfsp002\"\r\n                            }\r\n                        }\r\n                    },\r\n                    \"Cdtr\": {\r\n                        \"Nm\": \"April Sam Adamson\",\r\n                        \"Id\": {\r\n                            \"PrvtId\": {\r\n                                \"DtAndPlcOfBirth\": {\r\n                                    \"BirthDt\": \"1923-04-26\",\r\n                                    \"CityOfBirth\": \"Unknown\",\r\n                                    \"CtryOfBirth\": \"ZZ\"\r\n                                },\r\n                                \"Othr\": {\r\n                                    \"Id\": \"+27782722305\",\r\n                                    \"SchmeNm\": {\r\n                                        \"Prtry\": \"MSISDN\"\r\n                                    }\r\n                                }\r\n                            }\r\n                        },\r\n                        \"CtctDtls\": {\r\n                            \"MobNb\": \"+27-782722305\"\r\n                        }\r\n                    },\r\n                    \"CdtrAcct\": {\r\n                        \"Id\": {\r\n                            \"Othr\": {\r\n                                \"Id\": \"+27783078685\",\r\n                                \"SchmeNm\": {\r\n                                    \"Prtry\": \"MSISDN\"\r\n                                }\r\n                            }\r\n                        },\r\n                        \"Nm\": \"April Adamson\"\r\n                    },\r\n                    \"Purp\": {\r\n                        \"Cd\": \"MP2P\"\r\n                    },\r\n                    \"RgltryRptg\": {\r\n                        \"Dtls\": {\r\n                            \"Tp\": \"BALANCE OF PAYMENTS\",\r\n                            \"Cd\": \"100\"\r\n                        }\r\n                    },\r\n                    \"RmtInf\": {\r\n                        \"Ustrd\": \"Payment of USD 49932566118723700.89 from Ivan to April\"\r\n                    },\r\n                    \"SplmtryData\": {\r\n                        \"Envlp\": {\r\n                            \"Doc\": {\r\n                                \"Cdtr\": {\r\n                                    \"FrstNm\": \"Ivan\",\r\n                                    \"MddlNm\": \"Reese\",\r\n                                    \"LastNm\": \"Russel-Klein\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"Dbtr\": {\r\n                                    \"FrstNm\": \"April\",\r\n                                    \"MddlNm\": \"Sam\",\r\n                                    \"LastNm\": \"Adamson\",\r\n                                    \"MrchntClssfctnCd\": \"BLANK\"\r\n                                },\r\n                                \"DbtrFinSvcsPrvdrFees\": {\r\n                                    \"Ccy\": \"USD\",\r\n                                    \"Amt\": \"499325661187237\"\r\n                                },\r\n                                \"Xprtn\": \"{{now}}\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            \"SplmtryData\": {\r\n                \"Envlp\": {\r\n                    \"Doc\": {\r\n                        \"InitgPty\": {\r\n                            \"InitrTp\": \"CONSUMER\",\r\n                            \"Glctn\": {\r\n                                \"Lat\": \"-3.1291\",\r\n                                \"Long\": \"39.0006\"\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"ruleResult\": {\r\n        \"id\": \"004@1.0.0\",\r\n        \"cfg\": \"1.0.0\",\r\n        \"result\": false,\r\n        \"reason\": \"asdf\",\r\n        \"subRuleRef\": \"123\"\r\n    },\r\n    \"networkMap\": {\r\n        \"_key\": \"26345403\",\r\n        \"_id\": \"networkConfiguration/26345403\",\r\n        \"_rev\": \"_cxc-1vO---\",\r\n        \"messages\": [\r\n            {\r\n                \"id\": \"001@1.0.0\",\r\n                \"host\": \"{{baseUrl}}/function/off-transaction-aggregation-decisioning-processor-rel-1-0-0\",\r\n                \"cfg\": \"1.0.0\",\r\n                \"txTp\": \"pain.001.001.11\",\r\n                \"channels\": [\r\n                    {\r\n                        \"id\": \"001@1.1\",\r\n                        \"host\": \"{{baseUrl}}/function/off-channel-aggregation-decisioning-processor-rel-1-0-0\",\r\n                        \"cfg\": \"1.0.0\",\r\n                        \"typologies\": [\r\n                            {\r\n                                \"id\": \"028@1.0.0\",\r\n                                \"host\": \"{{baseUrl}}/function/off-typology-processor{{version2}}\",\r\n                                \"cfg\": \"1.1.0\",\r\n                                \"rules\": [\r\n                                    {\r\n                                        \"id\": \"004@1.0.0\",\r\n                                        \"host\": \"{{baseUrl}}/function/off-rule-004-rel-1-0-0\",\r\n                                        \"cfg\": \"1.0.0\"\r\n                                    }\r\n                                ]\r\n                            }\r\n                        ]\r\n                    }\r\n                ]\r\n            }\r\n        ]\r\n    }\r\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "{{baseUrl}}/function/off-typology-processor{{version}}/execute",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"function",
								"off-typology-processor{{version}}",
								"execute"
							]
						}
					},
					"response": []
				}
			]
		}
	]
}